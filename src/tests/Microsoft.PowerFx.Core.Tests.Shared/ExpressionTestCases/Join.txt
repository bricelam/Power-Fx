#SETUP: PowerFxV1CompatibilityRules,StronglyTypedBuiltinEnums, SupportColumnNamesAsIdentifiers

// Blank args
>> Join(If(false,Table({a:1})),If(false,Table({b:1})),true)
Blank()

// Invalid arguments
>> Join(1/0, Table({SupplierId:"AAA111"}), LeftRecord.Id = RightRecord.SupplierId, JoinType.Full)
Errors: Error 6-7: Invalid argument type.|Error 0-4: The function 'Join' has some invalid arguments.|Error 40-50: Name isn't valid. 'LeftRecord' isn't recognized.|Error 50-53: The '.' operator cannot be used on Error values.|Error 56-67: Name isn't valid. 'RightRecord' isn't recognized.|Error 67-78: The '.' operator cannot be used on Error values.|Error 54-55: Incompatible types for comparison. These types can't be compared: Error, Error.

// 'JoinType' arg must be a plain enum value. Passing it through another function is not allowed.
>> Join(Table({Id:"AAA111"}),  Table({SupplierId:"AAA111"}), LeftRecord.Id = RightRecord.SupplierId, If(true,JoinType.Inner))
Errors: Error 98-121: Expected plain 'JoinType' enum value. Different enums or passing it throught another function is not supported i.e. Join(..., If(true, JoinType.Inner, JoinType.Full)).|Error 0-4: The function 'Join' has some invalid arguments.

// Testing error when evaluating the predicate
>> Join(Table({a:1},{a:1}),Table({b:1},{b:2}),1/0)
Table(Error({Kind:ErrorKind.Div0}),Error({Kind:ErrorKind.Div0}),Error({Kind:ErrorKind.Div0}),Error({Kind:ErrorKind.Div0}))

// Untyped blanks are not allowed.
>> Join(Blank(),Blank(),true)
Errors: Error 5-12: Invalid argument type.|Error 0-4: The function 'Join' has some invalid arguments.

>> Join(Table({a:1}),Table({b:1}),LeftRecord.a = RightRecord.b, JoinType.Inner, LeftRecord As Abc)
Errors: Error 5-17: Arguments starting from the 5th position are meant to rename columns and are expected to be 'As' node arguments i.e LeftRecord.Name As NewName.|Error 0-4: The function 'Join' has some invalid arguments.

>> Join(Table({a:1}),Table({b:1}),LeftRecord.a = RightRecord.b, JoinType.Inner, LeftRecord.Void As Abc)
Errors: Error 87-92: Name isn't valid. 'Void' isn't recognized.|Error 93-95: Invalid argument type.|Error 5-17: The specified column 'LeftRecord.Void' does not exist.|Error 0-4: The function 'Join' has some invalid arguments.

>> Join(Table({a:1}),Table({b:1}),LeftRecord.a = RightRecord.b, JoinType.Inner, Test.Void As Abc)
Errors: Error 77-81: Name isn't valid. 'Test' isn't recognized.|Error 81-86: The '.' operator cannot be used on Error values.|Error 87-89: Invalid argument type.|Error 0-4: The function 'Join' has some invalid arguments.

>> Join(Table({a:1}),Table({b:1}),LeftRecord.a = RightRecord.b, JoinType.Inner, LeftRecord.a As A1, RightRecord.b As A1)
Errors: Error 5-17: Data sources can't union due to duplicated columns: 'A1'.|Error 0-4: The function 'Join' has some invalid arguments.

>> Join(If(1/0, Table({a:1})), Table({b:1}), LeftRecord.a = RightRecord.b)
Error({Kind:ErrorKind.Div0})

>> Join(Table({a:1}), If(1/0, Table({b:1})), LeftRecord.a = RightRecord.b)
Error({Kind:ErrorKind.Div0})